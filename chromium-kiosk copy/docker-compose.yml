version: '3.8'

services:
  chromium-kiosk:
    build: .
    image: alpine-chromium-kiosk:latest
    container_name: chromium_kiosk
    # Required for Chromium to not crash
    shm_size: '2gb'
    environment:
      - DISPLAY=:1
      - HOME=/home/app
      - DBUS_SESSION_BUS_ADDRESS=unix:path=/dev/null # Tricks Chromium into thinking DBus is handled
      - CHROME_LOG_FILE=/dev/null                  # Keeps the internal log quiet
    ports:
      - "5900:5900"
    volumes:
      # Use a named volume to fix the permission issues you had earlier
      - chromium_data:/tmp/chromium-profile
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
    restart: unless-stopped

volumes:
  chromium_data: